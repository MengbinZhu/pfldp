PROGRAM MATMULTEST

IMPLICIT NONE

REAL(KIND=8) :: MATA(4,4)
REAL(KIND=8) :: MATB(4,1)
REAL(KIND=8) :: MATBT(1,4)
REAL(KIND=8) :: MATC(4,1)
REAL(KIND=8) :: MATVAL1(1,1)
REAL(KIND=8) :: MATVAL2(1,1)

MATA = RESHAPE((/3,2,3,4,5,1,7,5,4,8,2,3,4,2,7,5/),(/4,4/))
MATB = RESHAPE((/3,6,4,3/),(/4,1/))
MATBT = RESHAPE((/3,6,4,3/),(/1,4/))
MATC = MATMUL(MATA,MATB)
!PRINT*,MATC
MATVAL1 = MATMUL(MATBT,MATMUL(MATA,MATB))
MATVAL2 = MATMUL(MATMUL(MATBT,MATA),MATB)
PRINT*,MATVAL1
PRINT*,MATVAL2

END PROGRAM

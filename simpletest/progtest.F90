PROGRAM PROGTEST
IMPLICIT NONE

INTEGER(KIND=4),PARAMETER   :: IDIMV = 4
INTEGER(KIND=4),ALLOCATABLE :: SEEDA(:)
REAL(KIND=8)                :: NDMean, NDVar
REAL(KIND=8),ALLOCATABLE    :: NDNumb(:)
REAL(KIND=8),ALLOCATABLE    :: NDNumb2(:)
REAL(KIND=8),ALLOCATABLE    :: X(:,:)
REAL(KIND=8),ALLOCATABLE    :: A(:,:)

DIMENSION AB(4,4)
DOUBLE PRECISION AB,DET

!AB = RESHAPE((/3.0,5.0,11.0,5.0,-3.0,-5.0,8.0,-1.0,-2.0,1.0,5.0,-3.0,4.0,8.0,-7.0,-1.0/),(/4,4/))
ALLOCATE(SEEDA(IDIMV))
ALLOCATE(NDNumb(IDIMV))
ALLOCATE(NDNumb2(IDIMV))
ALLOCATE(X(IDIMV,IDIMV))
ALLOCATE(A(IDIMV,IDIMV))

AB = RESHAPE((/3.0,5.0,11.0,5.0,-3.0,-5.0,8.0,-1.0,-2.0,1.0,5.0,-3.0,4.0,8.0,-7.0,-1.0/),(/4,4/))
!A = RESHAPE((/4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4/),(/6,6/))
A = RESHAPE((/4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4/),(/4,4/))

SEEDA(:) = 10

NDMean     = 0
NDVar      = 1
NDNumb(:)  = 0.0

CALL RANDOM_SEED(PUT=SEEDA(1:IDIMV))

CALL NDGen(SEEDA, NDMean, NDVar, IDIMV, NDNumb)

CALL NDGen(SEEDA, NDMean, NDVar, IDIMV, NDNumb2)

CALL SQRTMAT(X,A,IDIMV)

CALL BSDET(AB,4,DET)
WRITE(*,10) DET
10 FORMAT(1X,'DET=',D15.6)

!PRINT*,NDNumb
!PRINT*,NDNumb2
PRINT*,A
PRINT*,X

END PROGRAM
